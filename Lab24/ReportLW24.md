# Отчет по лабораторной работе № 24
## по курсу "Фундаментальная информатика"

Студент группы М8О-108Б-23 Федорова Екатерина Васильевна

Работа выполнена 

Преподаватель: каф. 806 Севастьянов Виктор Сергеевич

1. **Тема**: Алгоритмы и структуры данных.
2. **Цель работы**: потренироваться в работе с деревьями выражений.
3. **Задание (вариант №23)**:
Составить программу выполнения преобразований арифметических выражений с применением деревьев. Преобразование выражения в дерево осуществляется методом Дейкстры.
Операнды в обрабатываемых выражениях целого типа. Преобразование выражения реализовать в виде набора подпрограмм. Программа должна вводить и печатать выражения в исходном
(текстовом) виде, преобразовывать их в деревья, выполнять заданные преобразования путем обращения к подпрограммам и печатать результаты в виде дерева и в текстовом представлении.

Программа должна обрабатывать все вхождения сходных фрагментов в апализируемых выражениях, а не только те, что приведены в примерах. Программу необходимо проверить на нескольких
выражениях, среди которых должны быть выражения, не содержащие преобразуемых элементов, содержащие ровно один такой элемент или несколько элементов,
подлежащих преобразованию, причем в «разных» местах дерева.

Задание варианта: Упростить дробь, сократив в числителе и знаменателе общие переменные и константы:

`(a*b*3)/(3*b*c) → a/c`, `a/(a*b) → 1/b`.

4. **Идея, метод, алгоритм решения задачи**:
- `leaf.h` и `leaf.c`: реализация структуры вершины дерева и функций, связанных с ними.
- `tree.h` и `tree.с`: реализация структуры дерева и функций, связанных с ним.
- `addfuncs.h` и `addfuncs.с`: реализация дополнительных функций и структур. Особенно интересны "полустек", итератор, функции для ОПН.
- `h.h` и `h.с`: реализация функций для выполнения поставленной вариантом задачи, а также вспомогательных структур.
- `lab24.c`: реализация "интерфейса" -- оболочка всей программы, общающейся с пользователем.
- `test1.txt`, `test2.txt` и `test3.txt`: файлы с тестовыми математическими выражениями.

5. **Сценарий выполнения работы**:
```
moscow@moscow:~/Рабочий стол/For Labs/ForLabs/Lab24$ make
gcc -std=c99 -pedantic -Wall -c addfuncs.c -o add.o
gcc -std=c99 -pedantic -Wall -c leaf.c -o leaf.o
gcc -std=c99 -pedantic -Wall -c tree.c -o tree.o
gcc -std=c99 -pedantic -Wall -c h.c -o h.o
gcc -std=c99 -pedantic -Wall -o client lab24.c add.o leaf.o tree.o h.o
valgrind --leak-check=yes -s ./client
==6474== Memcheck, a memory error detector
==6474== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==6474== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==6474== Command: ./client
==6474== 
Добро пожаловать!

Прежде, чем вводить математические выражения, пожалуйста, ознакомьтесь с особенностями:
	1. Делить на нуль нельзя.
	2. Показатель степени обязан быть вычислимым (т.е. не содержать букв или дробей).
	3. Внимательно следите за скобками! Программа не обработает корректно введённое выражение.
	4. Авторские пробелы не помешают работе программы.
	5. Опускать знак умножения между буквами или перед скобкой можно.
Данную справку можно вызвать с помощью буквы h.
Введите что-нибудь для продолжения.

Приятного пользования!

Запускаем...


Введите математическое выражение: 4/5

Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: i
------------------
    4
/
    5
Выражение: 4/5
------------------

Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: a
------------------
    4
/
    5
Сокращённое выражение: 4/5
------------------

Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: n
Введите математическое выражение: 5/5
Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: i
------------------
    5
/
    5
Выражение: 5/5
------------------

Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: a
------------------
1
Сокращённое выражение: 1
------------------

Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: q
==6474== 
==6474== HEAP SUMMARY:
==6474==     in use at exit: 0 bytes in 0 blocks
==6474==   total heap usage: 455 allocs, 455 frees, 111,240 bytes allocated
==6474== 
==6474== All heap blocks were freed -- no leaks are possible
==6474== 
==6474== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
```

6. **Протокол**:
```
moscow@moscow:~/Рабочий стол/For Labs/ForLabs/Lab24$ make
gcc -std=c99 -pedantic -Wall -c addfuncs.c -o add.o
gcc -std=c99 -pedantic -Wall -c leaf.c -o leaf.o
gcc -std=c99 -pedantic -Wall -c tree.c -o tree.o
gcc -std=c99 -pedantic -Wall -c h.c -o h.o
gcc -std=c99 -pedantic -Wall -o client lab24.c add.o leaf.o tree.o h.o
valgrind --leak-check=yes -s ./client
==6501== Memcheck, a memory error detector
==6501== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==6501== Using Valgrind-3.18.1 and LibVEX; rerun with -h for copyright info
==6501== Command: ./client
==6501== 
Добро пожаловать!

Прежде, чем вводить математические выражения, пожалуйста, ознакомьтесь с особенностями:
	1. Делить на нуль нельзя.
	2. Показатель степени обязан быть вычислимым (т.е. не содержать букв или дробей).
	3. Внимательно следите за скобками! Программа не обработает корректно введённое выражение.
	4. Авторские пробелы не помешают работе программы.
	5. Опускать знак умножения между буквами или перед скобкой можно.
Данную справку можно вызвать с помощью буквы h.
Введите что-нибудь для продолжения.

Приятного пользования!

Запускаем...


Введите математическое выражение: 4
Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: t

Выберете пакет тестов:
	1. Проверка ввода данных.
	2. Простые (наглядные) тесты.
	3. Сложные выражения.
Введите число: 1
Деление на нуль

Выражение: 1+a/0
    1
+
        a
    /
        0

    1
+
        a
    /
        0
error 1: присутствует явное деление на нуль.
1+a/0

------------------
------------------
Явное деление на нуль

Выражение: 3/(10-5-5)

    3
/
            10
        -
            5
    -
        5

    3
/
    0
error 1: присутствует явное деление на нуль.
3/0

------------------
------------------
Неявное деление на нуль

Выражение: 2*1/(a-a)

        2
    *
        1
/
        a
    -
        a


error 0: ошибок не найдено.
2/(a-a)

------------------
------------------
Буква в показателе степени

Выражение: 2^(3-a+a)

    2
^
            3
        -
            a
    +
        a

    2
^
            3
        -
            a
    +
        a
error 2: степень не целое число.
2^(3-a+a)

------------------
------------------
Невычислимое выражение в показателе степени

Выражение: 2^(1/5+3)

    2
^
            1
        /
            5
    +
        3

    2
^
            1
        /
            5
    +
        3
error 2: степень не целое число.
2^(1/5+3)

------------------
------------------
Что желаете сделать?
N для ввода нового выражения,
I для печати исходного выражения и соответствующего дерева,
A для печати выражения после сокращения и соответствующего дерева,
T для просмотра тестов,
H для печати памятки,
Q для выхода.
Введите букву действия: q
==6501== 
==6501== HEAP SUMMARY:
==6501==     in use at exit: 0 bytes in 0 blocks
==6501==   total heap usage: 875 allocs, 875 frees, 226,620 bytes allocated
==6501== 
==6501== All heap blocks were freed -- no leaks are possible
==6501== 
==6501== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
```

7. **Замечания автора** по существу работы: можно улучшить новыми функциями и оптимизацией. Оставила грязь.
8. **Выводы**: мне понравилось. Несмотря на всю сложность работы и просроченные дедлайны, мне очень понравилось её выполнять. Похоже, я даже сделала лишнее.
Много лишнего. Однако! Думаю, это того стоило. Грандиозная работа, которую выполняла беспрерывно более недели. По сравнению с ней, остальные лабораторные совсем не развивали усидчивость,
но вот ЭТА. Очень хотелось избавиться от унарного минуса и возведения в степень. В общем, я страдала, но страдала с наслаждением.
